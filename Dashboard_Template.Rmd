---
title: "FSB Internship Dashboard 2021"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
#runtime: shiny
---

```{r setup, include=FALSE,echo=FALSE}
knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning=FALSE)

#package intialization
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(tidyverse, #for data manipulation
               plotly, #for interactive plots
               flexdashboard, #to make a dashboard
               fontawesome, #for icons
               DT #for better tables
               )
#read in data
final_df <- read.csv('final_df.csv')
```

# Question and Insights {data-orientation=columns}

### Question

Using the FSB Student Survey, we are looking to answer these three questions:

1. If you have at least one internship, how much more likely are you to have a full-time job than if you did not have an internship?

2. What if you have two internships?

3. Does having an internship mean your salary level will be higher in your full-time job?

### Insights



# Survey Overview {data-orientation=columns}

Overview of survey responses
  
## row {data-width=500}

### Response Rate

```{r, echo = FALSE}
rate = round(100*nrow(final_df)/(1250*3), 0)
gauge(rate, min=0, max=100, symbol='%', gaugeSectors(
  success = c(70,100), warning = c(40,69), danger = c(0,39)
))
```

### Usable Responses

```{r,echo=FALSE}
nusable = nrow(final_df)
valueBox(nusable, icon = "fa-users")
```   
 
### Internship Breakdown

```{r,echo=FALSE}
p=ggplot(final_df, aes(x=survey_internships))+
  geom_bar(color="steelblue",fill="steelblue")+
  xlab("Number of Internships")+
  ylab("Number of Responses")+
  theme_bw()
ggplotly(p)
```


## row {data-height=600}

### Post-Graduation Plans
    
```{r,echo=FALSE}
p=final_df %>% 
  ggplot(aes(x=reorder(survey_plans,survey_plans,function(x)-length(x))))+
  geom_bar(color="steelblue",fill="steelblue")+
  xlab("Post Graduation Plans")+
  ylab("Number of Responses")+
  theme_bw()+
  theme(axis.text.x=element_text(angle=90))
ggplotly(p)
```
   
   

# Internships to Full-Time Jobs {data-orientation=columns}

## Column {data-width=400}

### Percentage of Full-Time Placement between 1 and 2 Internships

WE NEED TO CHANGE THIS TO BE PERCENTAGE OF PEOPLE WITH 1 INTERNSHIP GOT A FULLTIME JOB VS. PERCENTAGE OF PEOPLE WITH 2 INTERNSHIPS GOT A FULLTIME JOB

```{r,echo=FALSE}
internships_1_2 <- subset(final_df, survey_internships == 1 | survey_internships == 2)
internships_1_2$fulltimejob <- ifelse(internships_1_2$fulltimejob == 1, "yes", "no")
internships_1_2$fulltimejob <- as.factor(internships_1_2$fulltimejob)

p4 <- internships_1_2 %>%
  mutate(survey_internships = factor(survey_internships, levels = c("1", "2"))) %>%
  ggplot(aes(x = survey_internships, fill = fulltimejob)) +
  geom_bar(color = "steelblue") +
  xlab("Amount of Internships") +
  ylab("Number of Responses") +
  theme_bw() +
  labs(fill = "Full-Time Job")

ggplotly(p4)
```

### Internship to Salary Impact

```{r,echo=FALSE}
library(dplyr)

final_df <- final_df %>%
  mutate(internship = ifelse(survey_internships == 0, "no", "yes"))

final_df_mean_salaries <- final_df %>%
  filter(fulltimejob != 0)

final_df_mean_salaries <- final_df %>%
  group_by(major1) %>%
  mutate(survey_salary = ifelse(is.na(survey_salary), mean(survey_salary, na.rm = TRUE), survey_salary))

mean_salary_data <- final_df_mean_salaries %>%
  group_by(internship) %>%
  summarise(mean_salary = mean(survey_salary, na.rm = TRUE))

p <- ggplot(mean_salary_data, aes(x = internship, y = mean_salary)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  xlab("Internships (Yes/No)") +
  ylab("Mean Survey Salary") +
  scale_y_continuous(labels = scales::dollar_format(prefix = "$")) +
  theme_bw()

ggplotly(p)

```

## Column {data-width=600}

### Number of Internships to Full-Time

```{r,echo=FALSE}
final_df$fulltimejob_yes <- ifelse(final_df$fulltimejob == 1, "yes", "no")
final_df$fulltimejob_yes <- as.factor(final_df$fulltimejob_yes)

p <- final_df %>%
  ggplot(aes(x = survey_internships, fill = fulltimejob_yes)) +
  geom_bar(color = "steelblue") +
  xlab("Amount of Internships") +
  ylab("Number of Responses") +
  theme_bw() +
  labs(fill = "Full-Time Job")
ggplotly(p)
```

