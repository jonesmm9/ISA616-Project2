---
title: "FSB Internship Dashboard 2021"
output: 
  flexdashboard::flex_dashboard:
    orientation: rows
#runtime: shiny
---

```{r setup, include=FALSE,echo=FALSE}
knitr::opts_chunk$set(echo = TRUE,message=FALSE,warning=FALSE)

#package initialization
if(require(pacman)==FALSE) install.packages("pacman")
pacman::p_load(tidyverse, #for data manipulation
               plotly, #for interactive plots
               flexdashboard, #to make a dashboard
               fontawesome, #for icons
               DT, #for better tables
               scales # for formatting axis labels
               )
#read in data
final_df <- read.csv('final_df.csv')
```
test
# Question and Insights {data-orientation=columns}

### Question

Using the FSB Student Survey, we are looking to answer these three questions:

1. If you have at least one internship, how much more likely are you to have a full-time job than if you did not have an internship?

2. What if you have two internships?

3. Does having an internship mean your salary level will be higher in your full-time job?

### Insights

After analyzing our data, we found answers to each of the three questions above: 

1. Looking at the tab titled "Internships to Full-Time Jobs", the graph of "Percentage of Students with Full-Time Jobs by Number of Internships" shows that 57.69% of students who had 0 internships got full-time jobs post graduation, while 83.04% of students who had 1 internship got a full-time job. We can also see that students with 2, 3, 4, and 5 internships all had full-time job percentages much higher than students with 0 internships. 

2. Looking at the tab titled "Internships to Full-Time Jobs", the graph of "Percentage of Students with Full-Time Jobs by Number of Internships" shows that 83.04% of people who had 1 internship got a full-time job post graduation, while 89.31% of students with 2 internships got a full-time job post graduation. 

3. Looking at the tab titled "Internships to Full-Time Jobs", the graph of "Internship to Salary Impact" shows that there is a ~$5,000 difference in starting salary between students who had one internship vs. students who had zero internships. 


# Survey Overview {data-orientation=columns}

Overview of survey responses
  
## row {data-width=500}

### Response Rate

```{r, echo = FALSE}
rate <- round(100 * nrow(final_df) / (1250 * 3), 0)

gauge(rate,
  min = 0,
  max = 100,
  symbol = '%',
  gaugeSectors(
    success = c(70, 100),
    warning = c(40, 69),
    danger = c(0, 39)
  )
)

```

### Usable Responses

```{r,echo=FALSE}
nusable <- nrow(final_df)
valueBox(nusable, icon = "fa-users")
```   
 
### Internship Breakdown

```{r,echo=FALSE}
p <- ggplot(final_df, aes(x = survey_internships)) +
  geom_bar(color = "steelblue", fill = "steelblue") +
  xlab("Number of Internships") +
  ylab("Number of Responses") +
  theme_bw()

ggplotly(p)
```


## row {data-height=600}

### Post-Graduation Plans
    
```{r,echo=FALSE}
p <- final_df %>%
  ggplot(aes(x = reorder(survey_plans, survey_plans, function(x) -length(x)))) +
  geom_bar(color = "steelblue", fill = "steelblue") +
  xlab("Post Graduation Plans") +
  ylab("Number of Responses") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 45))

ggplotly(p)
```


# Internships to Full-Time Jobs {data-orientation=columns}

## Column {data-width=400}

### Number of Internships to Full-Time

```{r,echo=FALSE}
final_df$fulltimejob_yes <- ifelse(final_df$fulltimejob == 1, "yes", "no")
final_df$fulltimejob_yes <- as.factor(final_df$fulltimejob_yes)

p <- final_df %>%
  ggplot(aes(x = survey_internships, fill = fulltimejob_yes)) +
  geom_bar(color = "steelblue") +
  xlab("Amount of Internships") +
  ylab("Number of Responses") +
  theme_bw() +
  labs(fill = "Full-Time Job")

ggplotly(p)

```

### Internship to Salary Impact

```{r,echo=FALSE}
final_df <- final_df %>%
  mutate(internship = ifelse(survey_internships == 0, "no", "yes"))

final_df_mean_salaries <- final_df %>%
  filter(fulltimejob != 0) %>%
  group_by(major1) %>%
  mutate(survey_salary = ifelse(is.na(survey_salary), mean(survey_salary, na.rm = TRUE), survey_salary))

mean_salary_data <- final_df_mean_salaries %>%
  group_by(internship) %>%
  summarise(mean_salary = round(mean(survey_salary, na.rm = TRUE)),0)

p <- ggplot(mean_salary_data, aes(x = internship, y = mean_salary)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  xlab("Internships (Yes/No)") +
  ylab("Mean Survey Salary") +
  scale_y_continuous(labels = dollar_format(prefix = "$")) +
  geom_text(aes(label = mean_salary), vjust = -0.5) + 
  theme_bw()

ggplotly(p)

```

## Column {data-width=600}

### Percentage of Students with Full-Time Jobs by Number of Internships

```{r,echo=FALSE}
# Add a new column 'fulltimejob_yes' based on the 'fulltimejob' column
final_df$fulltimejob_yes <- ifelse(final_df$fulltimejob == 1, "yes", "no")
final_df$fulltimejob_yes <- as.factor(final_df$fulltimejob_yes)

# Calculate the percentage of 'yes' responses and the count based on 'survey_internships'
percentage_data <- final_df %>%
  group_by(survey_internships) %>%
  summarize(
    percentage = sum(fulltimejob_yes == "yes") / n(),
    count = n()
  )

# Create a bar plot of the calculated percentages
p <- percentage_data %>%
  ggplot(aes(x = survey_internships, y = percentage)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  xlab("Amount of Internships") +
  ylab("Percentage of 'yes' responses") +
  theme_bw() +
  labs(fill = "Full-Time Job") +
  geom_text(aes(label = scales::percent(percentage)), vjust = -0.5)

# Convert the plot to an interactive plot using ggplotly
ggplotly(p)

```

